from pathlib import Path

from conda_vulnerability_scanner.scanner import fetch_db, scan


def test_fetch_db(tmp_path, test_package_list_path):
    """
    This tests runs fetch_db and checks afterwards if scan works with the created db
    """
    db_dir = Path(tmp_path)
    fetch_db(db_dir)
    cves = scan(db_dir, test_package_list_path)
    assert len(cves) > 0
