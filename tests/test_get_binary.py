import subprocess

from conda_vulnerability_scanner.scanner import get_go_cpe_dictionary_binary, get_cpe2cve_binary


def test_get_go_cpe_dictionary_binary():
    with get_go_cpe_dictionary_binary() as binary:
        subprocess.check_call([binary, "--help"])

def test_get_cpe2cve_binary():
    with get_cpe2cve_binary() as binary:
        return_code = subprocess.call([binary, "--help"])
        assert return_code == 1
