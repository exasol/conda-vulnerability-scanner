import os
import tempfile
from pathlib import Path

from conda_security_scanner.scanner import fetch_cpe_dictionary, get_go_cpe_dictionary_binary


def test_cpe_directory_fetch():
    with get_go_cpe_dictionary_binary() as go_cpe_dictionary:
        with tempfile.TemporaryDirectory() as temp_dir:
            cpe_dictionary_file = fetch_cpe_dictionary(go_cpe_dictionary, Path(temp_dir))
            assert cpe_dictionary_file.is_file() and cpe_dictionary_file.name == "cpe.sqlite3"
